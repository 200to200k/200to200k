<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Site Sombre</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="header">
    <h1 class="title">Bienvenue sur Mon Site Sombre</h1>
  </header>

  <main class="main-content">
    <section class="block">
      <h2>BANKROLL</h2>
      <!-- Conteneur pour le tableau -->
      <div id="table-container">Chargement des données...</div>
    </section>
    <section class="block">
      <h2>Deuxième Block</h2>
      <p>Ajoutez votre contenu ici.</p>
    </section>
  </main>

  <footer class="footer">
    <p>&copy; 2025 Mon Site Sombre</p>
  </footer>

  <!-- Script JavaScript -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const tableContainer = document.getElementById("table-container");
      const googleSheetUrl = "https://docs.google.com/spreadsheets/d/1l_k_jNZZ38XiOeKbwI79xffMb0F8IfOGy9se9ugtkgU/gviz/tq?tqx=out:csv&sheet=Feuille1";

      // Fonction pour récupérer et afficher les données depuis l'URL CSV
      async function fetchTableDataFromCSV() {
        try {
          const response = await fetch(googleSheetUrl);
          if (!response.ok) {
            throw new Error(`Erreur HTTP : ${response.status}`);
          }
          const csvText = await response.text();

          // Convertir le CSV en tableau HTML
          const rows = csvText.split("\n");
          const table = document.createElement("table");
          table.style.margin = "0 auto";
          table.style.borderCollapse = "collapse";
          table.style.width = "80%";
          table.style.textAlign = "center";

          rows.forEach((row, rowIndex) => {
            const cols = row.split(",");
            const tableRow = table.insertRow();

            cols.forEach((col) => {
              const cellValue = col.replace(/"/g, "").trim();
              if (cellValue) { // Inclure uniquement les cellules non vides
                const cell = rowIndex === 0 ? document.createElement("th") : tableRow.insertCell();
                cell.textContent = cellValue;
                cell.style.border = "1px solid white";
                cell.style.padding = "10px";
                cell.style.textAlign = "center";
              }
            });
          });

          // Afficher le tableau dans le conteneur
          tableContainer.innerHTML = ""; // Supprimer le message de chargement
          tableContainer.appendChild(table);
        } catch (error) {
          console.error("Erreur lors de la récupération des données :", error);
          tableContainer.innerHTML = "Erreur lors du chargement des données. Veuillez réessayer.";
        }
      }

      // Mise à jour en temps réel toutes les 30 secondes
      fetchTableDataFromCSV();
      setInterval(fetchTableDataFromCSV, 30000);
    });
  </script>
</body>
</html>
