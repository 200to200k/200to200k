<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historique des Paris</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .result-buttons button {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Paris Sportifs</h1>
        <nav>
            <ul>
                <li><a href="home.html">Accueil</a></li>
                <li><a href="history.html" class="active">Historique</a></li>
                <li><a href="affiliation.html">Affiliation</a></li>
                <li><a href="giveaway.html">Concours</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="history-container">
            <h2>Historique des Paris</h2>

            <!-- Graphique -->
            <div class="chart-container">
                <canvas id="bankroll-chart"></canvas>
            </div>

            <!-- Formulaire pour ajouter un pari -->
            <form id="bet-form">
                <label for="date">Date :</label>
                <input type="date" id="date" name="date" required>
                
                <label for="sport">Sport :</label>
                <input type="text" id="sport" name="sport" required>
                
                <label for="bet">Paris :</label>
                <input type="text" id="bet" name="bet" required>
                
                <label for="stake">Mise (€) :</label>
                <input type="number" id="stake" name="stake" required>
                
                <label for="odds">Cote :</label>
                <input type="number" step="0.01" id="odds" name="odds" required>

                <button type="submit">Ajouter le pari</button>
            </form>

            <!-- Tableau des paris -->
            <table id="history-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Paris</th>
                        <th>Sport</th>
                        <th>Mise (€)</th>
                        <th>Mise (% bankroll)</th>
                        <th>Cote</th>
                        <th>Gain (€)</th>
                        <th>Résultat</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Les paris seront ajoutés ici dynamiquement -->
                </tbody>
            </table>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Paris Sportifs. Tous droits réservés.</p>
    </footer>

    <script>
        // Configuration initiale du graphique
        const ctx = document.getElementById('bankroll-chart').getContext('2d');
        const bankrollData = {
            labels: [], // Les dates seront ajoutées dynamiquement
            datasets: [{
                label: 'Évolution de la bankroll (€)',
                data: [], // Les valeurs de la bankroll seront ajoutées dynamiquement
                borderColor: '#f3a712',
                backgroundColor: 'rgba(243, 167, 18, 0.2)',
                borderWidth: 2,
                fill: true
            }]
        };

        const bankrollChart = new Chart(ctx, {
            type: 'line',
            data: bankrollData,
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Date'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Montant (€)'
                        },
                        min: 0 // La bankroll ne devrait pas être négative
                    }
                }
            }
        });

        // Gestion de l'ajout des paris et mise à jour du graphique
        const betForm = document.getElementById('bet-form');
        const historyTable = document.getElementById('history-table').getElementsByTagName('tbody')[0];

        // Initialisation de la bankroll
        let currentBankroll = 1000; // Vous pouvez définir la bankroll initiale ici

        betForm.addEventListener('submit', function(event) {
            event.preventDefault();

            // Récupérer les valeurs du formulaire
            const date = document.getElementById('date').value;
            const sport = document.getElementById('sport').value;
            const bet = document.getElementById('bet').value;
            const stake = parseFloat(document.getElementById('stake').value);
            const odds = parseFloat(document.getElementById('odds').value);

            // Calculer la mise en pourcentage de la bankroll
            const stakePercentage = ((stake / currentBankroll) * 100).toFixed(2);

            // Ajouter une nouvelle ligne au tableau
            const newRow = historyTable.insertRow();
            newRow.innerHTML = `
                <td>${date}</td>
                <td>${bet}</td>
                <td>${sport}</td>
                <td>${stake.toFixed(2)}</td>
                <td>${stakePercentage}%</td>
                <td>${odds}</td>
                <td>0.00</td>
                <td>En attente</td>
                <td class="result-buttons">
                    <button onclick="updateResult(this, 'win')">Gagné</button>
                    <button onclick="updateResult(this, 'lose')">Perdu</button>
                </td>
            `;

            // Réinitialiser le formulaire
            betForm.reset();
        });

        function updateResult(button, result) {
            const row = button.parentElement.parentElement;
            const stake = parseFloat(row.cells[3].innerText);
            const odds = parseFloat(row.cells[5].innerText);
            let gain;

            if (result === 'win') {
                gain = (stake * (odds - 1)).toFixed(2);
                currentBankroll += parseFloat(gain);
                row.cells[7].innerText = 'Gagné';
            } else {
                gain = (-stake).toFixed(2);
                currentBankroll -= stake;
                row.cells[7].innerText = 'Perdu';
            }

            row.cells[6].innerText = gain;

            // Mettre à jour le graphique
            const date = row.cells[0].innerText;
            bankrollData.labels.push(date);
            bankrollData.datasets[0].data.push(currentBankroll.toFixed(2));
            bankrollChart.update();

            // Désactiver les boutons après mise à jour
            const
::contentReference[oaicite:0]{index=0}
 
